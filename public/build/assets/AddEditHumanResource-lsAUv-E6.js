import{r as i,j as a,A as E}from"./app-C4wXoxS5.js";import{i as A}from"./image_map-NXhAFMho.js";import{a as P}from"./axios-CwWhapzk.js";import{s as I}from"./loadToastr-Boyx6Ea-.js";function C({resource_name:n,editHumanResourceData:l,onClose:h}){var g,j;const[e,d]=i.useState({name:"",email:"",password:"",phone:"",address:"",avatar:""}),[t,b]=i.useState({}),[y,u]=i.useState(!1),v=i.useRef(null),x=i.useRef(null),[_,f]=i.useState(null);i.useEffect(()=>{if(!e.avatar){f(A.blank_avatar);return}if(typeof e.avatar=="string")f(e.avatar);else{const s=URL.createObjectURL(e.avatar);return f(s),()=>URL.revokeObjectURL(s)}},[e.avatar]),i.useEffect(()=>{if(!x.current)return;const s=window.$(x.current);return s.on("hidden.bs.modal",()=>{h==null||h(),b({}),d({name:"",email:"",password:"",phone:"",address:"",avatar:""})}),()=>s.off("hidden.bs.modal")},[h]),i.useEffect(()=>{if(!(l!=null&&l.data))return;const{name:s,email:m,phone:c,address:r,img_url:p}=l.data;d({name:s||"",email:m||"",password:"",phone:c||"",address:r||"",avatar:p&&`${window.location.origin}/storage/${p}`||""})},[l]);const k=async s=>{var p;const m=bootstrap.Modal.getInstance(x.current);s.preventDefault(),u(!0),s.preventDefault();let c=(p=l==null?void 0:l.data)==null?void 0:p.id;const r=new FormData;e.avatar&&e.avatar instanceof File&&r.append("avatar",e.avatar),r.append("name",e.name||""),r.append("email",e.email||""),r.append("password",e.password||""),r.append("phone",e.phone||""),r.append("address",e.address||""),c&&r.append("_method","PATCH"),c&&r.append("id",c||""),await P.post(c?route("human_resources.update",{human_resource:n}):route("human_resources.create",{human_resource:n}),r,{headers:{"Content-Type":"multipart/form-data"}}).then(o=>{o.data.status===200?(I(o.data.message),m.hide(),E.reload({only:[`${n}s`]}),b({}),d({name:"",email:"",password:"",phone:"",address:"",avatar:""}),v.current.reset()):b(o.data.errors||{}),u(!1)}).catch(o=>{var w,N;b(((N=(w=o==null?void 0:o.response)==null?void 0:w.data)==null?void 0:N.errors)||{})})};return a.jsx(a.Fragment,{children:a.jsx("div",{className:"modal fade",ref:x,id:`kt_modal_add_edit_human_resource_${n}`,tabIndex:"-1","aria-hidden":"true",children:a.jsx("div",{className:"modal-dialog modal-dialog-centered mw-650px",children:a.jsxs("div",{className:"modal-content",children:[a.jsxs("div",{className:"modal-header",id:"kt_modal_add_edit_human_header",children:[a.jsxs("h2",{className:"fw-bold",children:[" ",(g=l==null?void 0:l.data)!=null&&g.id?"Edit":"Add"," ",((j=n==null?void 0:n.charAt(0))==null?void 0:j.toUpperCase())+(n==null?void 0:n.slice(1))]}),a.jsx("div",{className:"btn btn-icon btn-sm btn-active-icon-primary","data-bs-dismiss":"modal",children:a.jsx("span",{className:"svg-icon svg-icon-1",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("rect",{opacity:"0.5",x:"6",y:"17.3137",width:"16",height:"2",rx:"1",transform:"rotate(-45 6 17.3137)",fill:"currentColor"}),a.jsx("rect",{x:"7.41422",y:"6",width:"16",height:"2",rx:"1",transform:"rotate(45 7.41422 6)",fill:"currentColor"})]})})})]}),a.jsx("div",{className:"modal-body scroll-y mx-5 mx-xl-15 my-7",children:a.jsxs("form",{onSubmit:k,ref:v,id:"kt_modal_add_edit_human_form",className:"form",encType:"multipart/form-data",children:[a.jsxs("div",{className:"d-flex flex-column scroll-y me-n7 pe-7",id:"kt_modal_add_edit_human_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_add_edit_human_header","data-kt-scroll-wrappers":"#kt_modal_add_edit_human_scroll","data-kt-scroll-offset":"300px",children:[a.jsxs("div",{className:"fv-row mb-7",children:[a.jsx("label",{className:"d-block fw-semibold fs-6 mb-5",children:"Avatar"}),a.jsxs("div",{className:"image-input image-input-outline image-input-placeholder","data-kt-image-input":"true",children:[a.jsx("div",{className:"image-input-wrapper w-125px h-125px rounded border",style:{backgroundImage:`url(${_})`,backgroundSize:"contain",backgroundPosition:"center"}}),a.jsxs("label",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"change","data-bs-toggle":"tooltip",title:"Change avatar",children:[a.jsx("i",{className:"bi bi-pencil-fill fs-7"}),a.jsx("input",{type:"file",name:"avatar",accept:".png, .jpg, .jpeg",defaultValue:(e==null?void 0:e.avatar)||"",onChange:s=>{const m=s.target.files[0];d({...e,avatar:m})}}),a.jsx("input",{type:"hidden",name:"avatar_remove"})]}),a.jsx("span",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"cancel","data-bs-toggle":"tooltip",title:"Cancel avatar",onClick:()=>d({...e,avatar:""}),children:a.jsx("i",{className:"bi bi-x fs-2"})}),a.jsx("span",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"remove","data-bs-toggle":"tooltip",title:"Remove avatar",onClick:()=>d({...e,avatar:""}),children:a.jsx("i",{className:"bi bi-x fs-2"})})]}),a.jsx("div",{className:"form-text",children:"Allowed file types: png, jpg, jpeg."}),t.avatar&&a.jsx("div",{className:"text-danger",children:t.avatar})]}),a.jsxs("div",{className:"fv-row mb-7",children:[a.jsx("label",{className:"required fw-semibold fs-6 mb-2",children:"Full Name"}),a.jsx("input",{type:"text",name:"name",onInput:s=>d({...e,name:s.target.value}),className:"form-control form-control-solid mb-3 mb-lg-0",placeholder:"Full name",defaultValue:(e==null?void 0:e.name)||""}),t.name&&a.jsx("div",{className:"text-danger",children:t.name})]}),a.jsxs("div",{className:"fv-row mb-7",children:[a.jsx("label",{className:"required fw-semibold fs-6 mb-2",children:"Password"}),a.jsx("input",{type:"password",name:"password",onInput:s=>d({...e,password:s.target.value}),className:"form-control form-control-solid mb-3 mb-lg-0",placeholder:"Password"}),t.password&&a.jsx("div",{className:"text-danger",children:t.password})]}),a.jsxs("div",{className:"fv-row mb-7",children:[a.jsx("label",{className:"required fw-semibold fs-6 mb-2",children:"Email"}),a.jsx("input",{type:"email",name:"email",onInput:s=>d({...e,email:s.target.value}),className:"form-control form-control-solid mb-3 mb-lg-0",placeholder:"example@domain.com",defaultValue:(e==null?void 0:e.email)||""}),t.email&&a.jsx("div",{className:"text-danger",children:t.email})]}),a.jsxs("div",{className:"fv-row mb-7",children:[a.jsx("label",{className:"required fw-semibold fs-6 mb-2",children:"Phone"}),a.jsx("input",{type:"text",name:"phone",className:"form-control form-control-solid mb-3 mb-lg-0",onInput:s=>d({...e,phone:s.target.value}),placeholder:"Enter Phone",defaultValue:(e==null?void 0:e.phone)||""}),t.phone&&a.jsx("div",{className:"text-danger",children:t.phone})]}),a.jsxs("div",{className:"fv-row mb-7",children:[a.jsx("label",{className:"fs-6 mb-2",children:"Address"}),a.jsx("input",{type:"text",name:"address",onInput:s=>d({...e,address:s.target.value}),className:"form-control form-control-solid mb-3 mb-lg-0",defaultValue:(e==null?void 0:e.address)||"",placeholder:"Enter Address"}),t.address&&a.jsx("div",{className:"text-danger",children:t.address})]})]}),a.jsxs("div",{className:"text-center pt-15",children:[a.jsx("button",{type:"reset",className:"btn btn-light me-3","data-bs-dismiss":"modal",children:"Discard"}),a.jsxs("button",{disabled:y?"disabled":"",type:"submit",className:"btn btn-primary","data-kt-users-modal-action":"submit",children:[a.jsx("span",{className:"indicator-label",children:"Submit"}),a.jsxs("span",{className:"indicator-progress",children:["Please wait...",a.jsx("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]})]})]})})]})})})})}export{C as A};
