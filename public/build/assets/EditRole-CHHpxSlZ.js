import{X as j,r as d,j as e,S as N,x as g}from"./app-C4wXoxS5.js";import{A as v}from"./AuthenticatedLayout-EbcPeVXy.js";import{a as _}from"./axios-CwWhapzk.js";import{s as k,a as y}from"./loadToastr-Boyx6Ea-.js";import"./index-BuezaGOJ.js";import"./image_map-NXhAFMho.js";import"./SidebarFunctions--M7IGmjx.js";function A({auth:x}){const{role:n,modules:r}=j().props,[m,o]=d.useState(!1),[w,E]=d.useState(!1),[f,u]=d.useState(n.label),[t,h]=d.useState(null);d.useEffect(()=>{if(!r)return;const a={};r.forEach(l=>{l.module_permissions.forEach(s=>{a[s.id]={status:!!s.status}})}),o(a)},[r]);const b=(a,l)=>s=>{const c=s.target.checked;o(i=>({...i,[a]:{...i[a],[l]:c}}))},p=a=>{h(null),a.preventDefault();let l={};for(const[s,c]of Object.entries(m))c.status&&(l[s]={status:c.status?1:0});_.patch(route("roles.update",n.id),{permissions:l,role_name:f}).then(s=>{s.data.status===200?k(s.data.message):(h(s.data.errors),y(s.data.message),scrollTo(0,0,{behavior:"smooth"}))})};return e.jsxs(v,{user:x.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Edit Role"}),children:[e.jsx(N,{title:"Edit Role"}),e.jsx(e.Fragment,{children:e.jsx("div",{className:"app-main flex-column flex-row-fluid",id:"kt_app_main",children:e.jsxs("div",{className:"d-flex flex-column flex-column-fluid",children:[e.jsx("div",{id:"kt_app_toolbar",className:"app-toolbar py-3 py-lg-6",children:e.jsx("div",{id:"kt_app_toolbar_container",className:"app-container container-fluid d-flex flex-stack",children:e.jsxs("div",{className:"page-title d-flex flex-column justify-content-center flex-wrap me-3",children:[e.jsx("h1",{className:"page-heading d-flex text-dark fw-bold fs-3 flex-column justify-content-center my-0",children:"Edit Role"}),e.jsxs("ul",{className:"breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1",children:[e.jsx("li",{className:"breadcrumb-item text-muted",children:e.jsx(g,{href:"/dashboard",className:"text-muted text-hover-primary",children:"Home"})}),e.jsx("li",{className:"breadcrumb-item",children:e.jsx("span",{className:"bullet bg-gray-400 w-5px h-2px"})}),e.jsx("li",{className:"breadcrumb-item text-muted",children:"User Management"}),e.jsx("li",{className:"breadcrumb-item",children:e.jsx("span",{className:"bullet bg-gray-400 w-5px h-2px"})}),e.jsx("li",{className:"breadcrumb-item text-muted",children:"Edit Role"})]})]})})}),e.jsx("div",{id:"kt_app_content",className:"app-content flex-column-fluid",children:e.jsx("div",{id:"kt_app_content_container",className:"app-container container-fluid",children:e.jsx("div",{className:"card card-dashed shadow-sm pt-3 mb-5 mb-lg-10",children:e.jsxs("form",{className:"form w-100",noValidate:"novalidate",id:"kt_sign_in_form",onSubmit:p,children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"card-title",children:e.jsx("h2",{className:"fw-bold",children:"Edit Role"})})}),e.jsxs("div",{className:"card-body ",children:[e.jsxs("div",{className:"mb-10 fv-row",children:[e.jsx("label",{className:"required form-label",children:"Role Name"}),e.jsx("input",{type:"text",name:"role_name",className:"form-control mb-2",placeholder:"Role name",defaultValue:n.label,onInput:a=>u(a.target.value)}),t&&t.role_name&&e.jsx("span",{className:"text-danger",children:t.role_name[0]}),t&&t.permissions&&e.jsx("span",{className:"text-danger",children:t.permissions[0]})]}),e.jsxs("div",{className:"card-footer d-flex justify-content-start py-6 px-9",children:[e.jsx("button",{type:"reset",className:"btn btn-light btn-active-light-primary me-2",children:"Discard"}),e.jsx("button",{type:"submit",className:"btn btn-primary",id:"kt_account_profile_details_submit",children:"Save Changes"})]}),e.jsxs("div",{className:"card bg-light card-dashed mb-10",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:e.jsx("h2",{className:"fw-bold",children:"Permissions"})}),e.jsxs("div",{className:"card-toolbar",children:[e.jsx("a",{href:"#",className:"btn btn-icon select_all btn-sm btn-info me-2",children:e.jsx("i",{className:"fas fa-check-square fs-4"})}),e.jsx("a",{href:"#",className:"btn btn-icon deselect_all btn-sm btn-danger",children:e.jsx("i",{className:"fas fa-times-circle fs-4"})})]})]}),e.jsx("div",{className:"card-body px-lg-5 py-lg-5",children:e.jsx("div",{className:"row g-6 g-xl-9",children:r&&r.map((a,l)=>e.jsx("div",{className:"col-sm-6 col-xl-4",children:e.jsxs("div",{className:"card card-bordered",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h5",{className:"card-title",children:a.name}),e.jsxs("div",{className:"card-toolbar",children:[e.jsx("a",{href:"#",className:"btn btn-icon btn-sm btn-info me-2 select_module",children:e.jsx("i",{className:"fas fa-check-square fs-4"})}),e.jsx("a",{href:"#",className:"btn btn-icon btn-sm btn-danger deselect_module",children:e.jsx("i",{className:"fas fa-times-circle fs-4"})})]})]}),e.jsx("div",{className:"card-body",children:a.module_permissions&&a.module_permissions.map((s,c)=>{var i;return e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"",children:e.jsx("a",{href:"#",className:"text-dark text-hover-primary fs-6 fw-bold",children:s.label})}),e.jsx("div",{className:"ms-auto",children:e.jsxs("div",{className:"form-check form-switch form-check-default form-check-custom form-check-success",children:[e.jsx("input",{className:"form-check-input permissions-form-check-input h-20px w-40px",type:"checkbox",id:`flexSwitchDefault${s.id}`,name:`status[${s.id}]`,checked:!!((i=m[s.id])!=null&&i.status),onChange:b(s.id,"status")}),e.jsx("label",{className:"form-check-label",htmlFor:`flexSwitchDefault${s.id}`})]})})]},c)})})]})},l))})})]})]})]})})})})]})})})]})}export{A as default};
